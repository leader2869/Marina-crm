# üí∞ –ú–æ–¥—É–ª—å "–î–æ—Ö–æ–¥—ã" –¥–ª—è —Å—É–¥–æ–≤–ª–∞–¥–µ–ª—å—Ü–∞ - –°—Ö–µ–º–∞

## üìã –û–±—â–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

–ú–æ–¥—É–ª—å –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—É–¥–æ–≤–ª–∞–¥–µ–ª—å—Ü—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–≤–æ–∏ –¥–æ—Ö–æ–¥—ã –æ—Ç —Å–¥–∞—á–∏ —Å—É–¥–Ω–∞ –≤ –∞—Ä–µ–Ω–¥—É –∏ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

---

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞: `vessel_owner_incomes`

```sql
CREATE TABLE vessel_owner_incomes (
  id SERIAL PRIMARY KEY,
  vessel_owner_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  vessel_id INTEGER REFERENCES vessels(id) ON DELETE SET NULL,
  booking_id INTEGER REFERENCES bookings(id) ON DELETE SET NULL,
  payment_id INTEGER REFERENCES payments(id) ON DELETE SET NULL,
  
  -- –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  type VARCHAR(50) NOT NULL, -- –¢–∏–ø –¥–æ—Ö–æ–¥–∞ (—Å–º. VesselOwnerIncomeType)
  amount DECIMAL(12, 2) NOT NULL,
  currency VARCHAR(3) DEFAULT 'RUB',
  date DATE NOT NULL,
  
  -- –û–ø–∏—Å–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã
  description TEXT,
  invoice_number VARCHAR(100),
  document_path TEXT,
  
  -- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  
  -- –ò–Ω–¥–µ–∫—Å—ã
  INDEX idx_vessel_owner_id (vessel_owner_id),
  INDEX idx_vessel_id (vessel_id),
  INDEX idx_booking_id (booking_id),
  INDEX idx_date (date),
  INDEX idx_type (type)
);
```

---

## üìä –¢–∏–ø—ã –¥–æ—Ö–æ–¥–æ–≤ (VesselOwnerIncomeType)

```typescript
export enum VesselOwnerIncomeType {
  // –î–æ—Ö–æ–¥—ã –æ—Ç –∞—Ä–µ–Ω–¥—ã —Å—É–¥–Ω–∞
  RENTAL_PAYMENT = 'rental_payment',           // –ü–ª–∞—Ç–µ–∂ –∑–∞ –∞—Ä–µ–Ω–¥—É –º–µ—Å—Ç–∞ (–æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ—Ö–æ–¥)
  RENTAL_DEPOSIT = 'rental_deposit',           // –ó–∞–ª–æ–≥ –∑–∞ –∞—Ä–µ–Ω–¥—É
  RENTAL_REFUND = 'rental_refund',             // –í–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤ –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ
  
  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏
  CHARTER_SERVICE = 'charter_service',         // –£—Å–ª—É–≥–∏ —á–∞—Ä—Ç–µ—Ä–∞ (—Å–¥–∞—á–∞ —Å—É–¥–Ω–∞ –≤ –∞—Ä–µ–Ω–¥—É –¥—Ä—É–≥–∏–º)
  MAINTENANCE_SERVICE = 'maintenance_service',  // –£—Å–ª—É–≥–∏ –ø–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é
  TRANSPORT_SERVICE = 'transport_service',      // –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏
  
  // –ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã
  INSURANCE_COMPENSATION = 'insurance_compensation', // –°—Ç—Ä–∞—Ö–æ–≤—ã–µ –≤—ã–ø–ª–∞—Ç—ã
  OTHER = 'other'                              // –ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã
}
```

---

## üîó –°–≤—è–∑–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏

### 1. –°–≤—è–∑—å —Å User (—Å—É–¥–æ–≤–ª–∞–¥–µ–ª–µ—Ü)
- `vessel_owner_id` ‚Üí `users.id`
- –û–¥–∏–Ω —Å—É–¥–æ–≤–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –º–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–æ–≤

### 2. –°–≤—è–∑—å —Å Vessel (—Å—É–¥–Ω–æ)
- `vessel_id` ‚Üí `vessels.id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –¥–æ—Ö–æ–¥—ã –ø–æ –∫–∞–∂–¥–æ–º—É —Å—É–¥–Ω—É –æ—Ç–¥–µ–ª—å–Ω–æ

### 3. –°–≤—è–∑—å —Å Booking (–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
- `booking_id` ‚Üí `bookings.id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–≤—è–∑–∞—Ç—å –¥–æ—Ö–æ–¥ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º

### 4. –°–≤—è–∑—å —Å Payment (–ø–ª–∞—Ç–µ–∂)
- `payment_id` ‚Üí `payments.id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–æ—Ö–æ–¥ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ –ø–ª–∞—Ç–µ–∂–∞

---

## üéØ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ—Ö–æ–¥–∞ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ
**–ö–æ–≥–¥–∞:** –°—É–¥–æ–≤–ª–∞–¥–µ–ª–µ—Ü –ø–æ–ª—É—á–∞–µ—Ç –æ–ø–ª–∞—Ç—É –∑–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞ –Ω–∞ `PAID`
2. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–ª–∞—Ç–µ–∂ —Å–≤—è–∑–∞–Ω —Å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å—É–¥–æ–≤–ª–∞–¥–µ–ª—å—Ü–∞
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –¥–æ—Ö–æ–¥–∞:
   - `type`: `RENTAL_PAYMENT`
   - `amount`: —Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞
   - `vessel_owner_id`: –≤–ª–∞–¥–µ–ª–µ—Ü —Å—É–¥–Ω–∞ –∏–∑ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
   - `vessel_id`: —Å—É–¥–Ω–æ –∏–∑ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
   - `booking_id`: ID –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
   - `payment_id`: ID –ø–ª–∞—Ç–µ–∂–∞
   - `date`: –¥–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã (`paidDate`)

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –†—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∞
**–ö–æ–≥–¥–∞:** –°—É–¥–æ–≤–ª–∞–¥–µ–ª–µ—Ü —Ö–æ—á–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥ –æ—Ç –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

**–ü–æ–ª—è:**
- –¢–∏–ø –¥–æ—Ö–æ–¥–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –°—É–º–º–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –î–∞—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –°—É–¥–Ω–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ù–æ–º–µ—Ä —Å—á–µ—Ç–∞/–¥–æ–∫—É–º–µ–Ω—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –§–∞–π–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –í–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤
**–ö–æ–≥–¥–∞:** –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ, —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–∏ –æ—Ç–º–µ–Ω–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º —Å—Ä–µ–¥—Å—Ç–≤
2. –°–æ–∑–¥–∞–µ—Ç—Å—è –¥–æ—Ö–æ–¥ —Å —Ç–∏–ø–æ–º `RENTAL_REFUND`
3. –°—É–º–º–∞ = —Å—É–º–º–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å)

---

## üì± –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### 1. –°–ø–∏—Å–æ–∫ –¥–æ—Ö–æ–¥–æ–≤
**–≠–∫—Ä–∞–Ω:** `/incomes`

**–§—É–Ω–∫—Ü–∏–∏:**
- –¢–∞–±–ª–∏—Ü–∞ —Å –¥–æ—Ö–æ–¥–∞–º–∏
- –§–∏–ª—å—Ç—Ä—ã:
  - –ü–æ –¥–∞—Ç–µ (–ø–µ—Ä–∏–æ–¥)
  - –ü–æ —Ç–∏–ø—É –¥–æ—Ö–æ–¥–∞
  - –ü–æ —Å—É–¥–Ω—É
  - –ü–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—é
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:
  - –ü–æ –¥–∞—Ç–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é DESC - –Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
  - –ü–æ —Å—É–º–º–µ
  - –ü–æ —Ç–∏–ø—É
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è

**–ö–æ–ª–æ–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—ã:**
- –î–∞—Ç–∞
- –¢–∏–ø –¥–æ—Ö–æ–¥–∞
- –°—É–º–º–∞ + –≤–∞–ª—é—Ç–∞
- –°—É–¥–Ω–æ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ)
- –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ)
- –û–ø–∏—Å–∞–Ω–∏–µ
- –î–µ–π—Å—Ç–≤–∏—è (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å, —É–¥–∞–ª–∏—Ç—å)

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∞
**–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ / –û—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**

**–ü–æ–ª—è —Ñ–æ—Ä–º—ã:**
- –¢–∏–ø –¥–æ—Ö–æ–¥–∞ * (–≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫)
- –°—É–º–º–∞ * (—á–∏—Å–ª–æ, 2 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)
- –í–∞–ª—é—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é RUB)
- –î–∞—Ç–∞ * (–∫–∞–ª–µ–Ω–¥–∞—Ä—å)
- –°—É–¥–Ω–æ (–≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ —Å—É–¥–æ–≤ —Å—É–¥–æ–≤–ª–∞–¥–µ–ª—å—Ü–∞, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ —Å—É–¥–Ω–æ)
- –û–ø–∏—Å–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ)
- –ù–æ–º–µ—Ä —Å—á–µ—Ç–∞/–¥–æ–∫—É–º–µ–Ω—Ç–∞ (—Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ)
- –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç (—Ñ–∞–π–ª)

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –°—É–º–º–∞ > 0
- –î–∞—Ç–∞ –Ω–µ –≤ –±—É–¥—É—â–µ–º (–∏–ª–∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å?)
- –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ–Ω–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Å—É–¥–æ–≤–ª–∞–¥–µ–ª—å—Ü—É

### 3. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Ö–æ–¥–∞
**–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é**, –Ω–æ:
- –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ –ø–æ–ª—è
- –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–æ—Ö–æ–¥—ã (—Å `payment_id`)

### 4. –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∞
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
- –ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–æ—Ö–æ–¥—ã (—Å `payment_id`)
- –ò–ª–∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º

### 5. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
**–í–∏–¥–∂–µ—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:**

1. **–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
   - –û–±—â–∞—è —Å—É–º–º–∞ –¥–æ—Ö–æ–¥–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
   - –°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –∑–∞ –ø–µ—Ä–∏–æ–¥

2. **–ü–æ —Ç–∏–ø–∞–º:**
   - –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ —Ç–∏–ø–∞–º
   - –°–ø–∏—Å–æ–∫ —Ç–∏–ø–æ–≤ —Å —Å—É–º–º–∞–º–∏

3. **–ü–æ —Å—É–¥–∞–º:**
   - –¢–∞–±–ª–∏—Ü–∞ –¥–æ—Ö–æ–¥–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É —Å—É–¥–Ω—É
   - –°—É–º–º–∞ –¥–æ—Ö–æ–¥–æ–≤ –Ω–∞ —Å—É–¥–Ω–æ

4. **–ü–æ –ø–µ—Ä–∏–æ–¥–∞–º:**
   - –ì—Ä–∞—Ñ–∏–∫ –¥–æ—Ö–æ–¥–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º/–Ω–µ–¥–µ–ª—è–º
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤

5. **–¢–æ–ø –¥–æ—Ö–æ–¥–æ–≤:**
   - –°–∞–º—ã–µ –∫—Ä—É–ø–Ω—ã–µ –¥–æ—Ö–æ–¥—ã –∑–∞ –ø–µ—Ä–∏–æ–¥

---

## üîÑ API Endpoints

### GET `/api/vessel-owner/incomes`
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Ö–æ–¥–æ–≤ —Å—É–¥–æ–≤–ª–∞–¥–µ–ª—å—Ü–∞

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- `startDate` - –Ω–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ (—Ñ–∏–ª—å—Ç—Ä)
- `endDate` - –∫–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞ (—Ñ–∏–ª—å—Ç—Ä)
- `type` - —Ç–∏–ø –¥–æ—Ö–æ–¥–∞ (—Ñ–∏–ª—å—Ç—Ä)
- `vesselId` - ID —Å—É–¥–Ω–∞ (—Ñ–∏–ª—å—Ç—Ä)
- `bookingId` - ID –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (—Ñ–∏–ª—å—Ç—Ä)

**–û—Ç–≤–µ—Ç:**
```json
{
  "data": [
    {
      "id": 1,
      "type": "rental_payment",
      "amount": 50000,
      "currency": "RUB",
      "date": "2025-11-15",
      "description": "–û–ø–ª–∞—Ç–∞ –∑–∞ –∞—Ä–µ–Ω–¥—É –º–µ—Å—Ç–∞",
      "invoiceNumber": "INV-001",
      "vesselId": 5,
      "vessel": { "id": 5, "name": "–Ø—Ö—Ç–∞-1" },
      "bookingId": 38,
      "booking": { "id": 38, "startDate": "2025-05-01" },
      "paymentId": 113,
      "createdAt": "2025-11-15T10:00:00Z"
    }
  ],
  "total": 100,
  "page": 1,
  "limit": 20
}
```

### POST `/api/vessel-owner/incomes`
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –¥–æ—Ö–æ–¥

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "type": "rental_payment",
  "amount": 50000,
  "currency": "RUB",
  "date": "2025-11-15",
  "vesselId": 5,
  "bookingId": 38,
  "description": "–û–ø–ª–∞—Ç–∞ –∑–∞ –∞—Ä–µ–Ω–¥—É –º–µ—Å—Ç–∞",
  "invoiceNumber": "INV-001"
}
```

### PUT `/api/vessel-owner/incomes/:id`
–û–±–Ω–æ–≤–∏—Ç—å –¥–æ—Ö–æ–¥

### DELETE `/api/vessel-owner/incomes/:id`
–£–¥–∞–ª–∏—Ç—å –¥–æ—Ö–æ–¥

### GET `/api/vessel-owner/incomes/analytics`
–ü–æ–ª—É—á–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–æ –¥–æ—Ö–æ–¥–∞–º

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `startDate` - –Ω–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞
- `endDate` - –∫–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞
- `groupBy` - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞: `type`, `vessel`, `month`, `week`

**–û—Ç–≤–µ—Ç:**
```json
{
  "totalAmount": 500000,
  "totalCount": 25,
  "averageAmount": 20000,
  "byType": [
    { "type": "rental_payment", "amount": 450000, "count": 20 },
    { "type": "charter_service", "amount": 50000, "count": 5 }
  ],
  "byVessel": [
    { "vesselId": 5, "vesselName": "–Ø—Ö—Ç–∞-1", "amount": 300000 },
    { "vesselId": 6, "vesselName": "–Ø—Ö—Ç–∞-2", "amount": 200000 }
  ],
  "byMonth": [
    { "month": "2025-05", "amount": 200000 },
    { "month": "2025-06", "amount": 300000 }
  ]
}
```

---

## üîê –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

- **–°—É–¥–æ–≤–ª–∞–¥–µ–ª–µ—Ü** –º–æ–∂–µ—Ç:
  - –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–æ—Ö–æ–¥—ã
  - –°–æ–∑–¥–∞–≤–∞—Ç—å –¥–æ—Ö–æ–¥—ã –¥–ª—è —Å–µ–±—è
  - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–æ—Ö–æ–¥—ã (–∫—Ä–æ–º–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö)
  - –£–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–æ—Ö–æ–¥—ã (–∫—Ä–æ–º–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö)

- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä/–°—É–ø–µ—Ä–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** –º–æ–∂–µ—Ç:
  - –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—Å–µ –¥–æ—Ö–æ–¥—ã
  - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª—è—Ç—å –ª—é–±—ã–µ –¥–æ—Ö–æ–¥—ã

---

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ—Ö–æ–¥–∞ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ

**–ú–µ—Å—Ç–æ:** `src/modules/payments/payments.controller.ts` ‚Üí –º–µ—Ç–æ–¥ `updateStatus`

**–õ–æ–≥–∏–∫–∞:**
```typescript
if (status === PaymentStatus.PAID) {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
  
  // –°–æ–∑–¥–∞–µ–º –¥–æ—Ö–æ–¥ –¥–ª—è —Å—É–¥–æ–≤–ª–∞–¥–µ–ª—å—Ü–∞
  const booking = await bookingRepository.findOne({
    where: { id: payment.bookingId },
    relations: ['vessel', 'vesselOwner']
  });
  
  if (booking && booking.vesselOwnerId) {
    const incomeRepository = AppDataSource.getRepository(VesselOwnerIncome);
    const income = incomeRepository.create({
      vesselOwnerId: booking.vesselOwnerId,
      vesselId: booking.vesselId,
      bookingId: booking.id,
      paymentId: payment.id,
      type: VesselOwnerIncomeType.RENTAL_PAYMENT,
      amount: payment.amount,
      currency: payment.currency,
      date: payment.paidDate || new Date(),
      description: `–û–ø–ª–∞—Ç–∞ –∑–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ #${booking.id}`
    });
    await incomeRepository.save(income);
  }
}
```

---

## üìà –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel/CSV
- –§–∏–ª—å—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ —ç–∫—Å–ø–æ—Ä—Ç—É

### 2. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ—Ö–æ–¥–∞
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π/–µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –æ—Ç—á–µ—Ç –æ –¥–æ—Ö–æ–¥–∞—Ö

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–∞–ª–æ–≥–∞–º–∏
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–æ—Ö–æ–¥–æ–≤ –¥–ª—è –Ω–∞–ª–æ–≥–æ–≤–æ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
- –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏–∏

### 4. –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü—Ä–æ–≥–Ω–æ–∑ –¥–æ—Ö–æ–¥–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤

---

## üé® UI/UX –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞:**
   - –î–æ—Ö–æ–¥—ã: –∑–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç (üí∞)
   - –ò–∫–æ–Ω–∫–∏: `TrendingUp` –¥–ª—è –¥–æ—Ö–æ–¥–æ–≤

2. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
   - –ì—Ä–∞—Ñ–∏–∫–∏ –¥–æ—Ö–æ–¥–æ–≤ –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º
   - –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ —Ç–∏–ø–∞–º
   - –¢–∞–±–ª–∏—Ü–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

3. **–£–¥–æ–±—Å—Ç–≤–æ:**
   - –ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∞ (–º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ)
   - –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
   - –ü–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é, –Ω–æ–º–µ—Ä—É —Å—á–µ—Ç–∞

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤:**
   - –¢–µ–∫—É—â–∞—è —Ç–∞–±–ª–∏—Ü–∞ `incomes` - –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∫–ª—É–±–æ–≤
   - –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `vessel_owner_incomes` - –¥–ª—è —Å—É–¥–æ–≤–ª–∞–¥–µ–ª—å—Ü–µ–≤
   - –†–∞–∑–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏, —Ä–∞–∑–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã

2. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
   - –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

3. **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:**
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–æ—Ö–æ–¥–æ–≤ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `paidDate`
   - –î–ª—è –Ω–æ–≤—ã—Ö - —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] –°–æ–∑–¥–∞—Ç—å entity `VesselOwnerIncome`
- [ ] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `vessel_owner_incomes`
- [ ] –î–æ–±–∞–≤–∏—Ç—å enum `VesselOwnerIncomeType` –≤ —Ç–∏–ø—ã
- [ ] –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä `VesselOwnerIncomesController`
- [ ] –°–æ–∑–¥–∞—Ç—å —Ä–æ—É—Ç—ã –¥–ª—è API
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ—Ö–æ–¥–∞ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É `/incomes` —Å —Ç–∞–±–ª–∏—Ü–µ–π
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É
- [ ] –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

