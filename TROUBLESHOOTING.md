# üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –û—à–∏–±–∫–∞ TypeScript

**–ü—Ä–æ–±–ª–µ–º–∞:** `Cannot find name 'OneToMany'`

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `OneToMany` –≤ —Ñ–∞–π–ª `src/entities/Booking.ts`

---

## ‚ùå –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ PostgreSQL

**–û—à–∏–±–∫–∞:** `password authentication failed for user "postgres"`

**–ö–æ–¥ –æ—à–∏–±–∫–∏:** `28P01`

### –ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç?

PostgreSQL –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

### –†–µ—à–µ–Ω–∏–µ –ø–æ —à–∞–≥–∞–º:

#### –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª .env

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç:

```env
DB_HOST=localhost
DB_PORT=5432
DB_NAME=marina_crm
DB_USER=postgres
DB_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å_–æ—Ç_postgres
```

#### –®–ê–ì 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å

1. **–û—Ç–∫—Ä–æ–π—Ç–µ pgAdmin 4**
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —Å –ø–∞—Ä–æ–ª–µ–º, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑–∞–Ω –≤ `.env`
3. –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è ‚Äî –ø–∞—Ä–æ–ª—å –Ω–µ–≤–µ—Ä–Ω—ã–π

#### –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω

1. –ù–∞–∂–º–∏—Ç–µ `Win + R`
2. –í–≤–µ–¥–∏—Ç–µ `services.msc`
3. –ù–∞–π–¥–∏—Ç–µ —Å–ª—É–∂–±—É **"postgresql-x64-14"** (–∏–ª–∏ –ø–æ—Ö–æ–∂—É—é)
4. –°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **"–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è"**
5. –ï—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ ‚Äî –Ω–∞–∂–º–∏—Ç–µ **"–ó–∞–ø—É—Å—Ç–∏—Ç—å"**

#### –®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

1. **–û—Ç–∫—Ä–æ–π—Ç–µ pgAdmin 4**
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `marina_crm` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
4. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ –µ—ë (—Å–º. `DATABASE_SETUP.md`)

#### –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –í pgAdmin –æ—Ç–∫—Ä–æ–π—Ç–µ: **Servers** ‚Üí **PostgreSQL 14** ‚Üí **Login/Group Roles**
2. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `postgres`
3. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è

–ï—Å–ª–∏ –∑–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å –æ—Ç PostgreSQL:

1. **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª—É–∂–±—É PostgreSQL** (—á–µ—Ä–µ–∑ `services.msc`)

2. **–ù–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª `pg_hba.conf`:**
   - –û–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤: `C:\Program Files\PostgreSQL\14\data\pg_hba.conf`

3. **–°–¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é:**
   ```bash
   copy "C:\Program Files\PostgreSQL\14\data\pg_hba.conf" "C:\Program Files\PostgreSQL\14\data\pg_hba.conf.backup"
   ```

4. **–û—Ç–∫—Ä–æ–π—Ç–µ `pg_hba.conf` –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ** (–æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)

5. **–ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É:**
   ```
   host    all             all             127.0.0.1/32            scram-sha-256
   ```

6. **–ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞:**
   ```
   host    all             all             127.0.0.1/32            trust
   ```

7. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª**

8. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É–∂–±—É PostgreSQL**

9. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –±–µ–∑ –ø–∞—Ä–æ–ª—è:**
   ```bash
   psql -U postgres
   ```

10. **–ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å:**
    ```sql
    ALTER USER postgres WITH PASSWORD '–Ω–æ–≤—ã–π_–ø–∞—Ä–æ–ª—å';
    ```

11. **–í–µ—Ä–Ω–∏—Ç–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π `pg_hba.conf`** (–∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏)

12. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É–∂–±—É PostgreSQL**

13. **–û–±–Ω–æ–≤–∏—Ç–µ `.env` —Ñ–∞–π–ª** —Å –Ω–æ–≤—ã–º –ø–∞—Ä–æ–ª–µ–º

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

- [ ] –§–∞–π–ª `.env` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
- [ ] –í `.env` —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `DB_PASSWORD`
- [ ] PostgreSQL –∑–∞–ø—É—â–µ–Ω (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ `services.msc`)
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `marina_crm` —Å–æ–∑–¥–∞–Ω–∞
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `postgres` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- [ ] –ü–∞—Ä–æ–ª—å –≤ `.env` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –ø–∞—Ä–æ–ª–µ–º –≤ PostgreSQL

---

## üß™ –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `test-db-connection.js`:

```javascript
const { Client } = require('pg');
require('dotenv').config();

console.log('–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î...');
console.log('Host:', process.env.DB_HOST);
console.log('Port:', process.env.DB_PORT);
console.log('Database:', process.env.DB_NAME);
console.log('User:', process.env.DB_USER);
console.log('Password:', process.env.DB_PASSWORD ? '***—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω***' : '‚ùå –ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù');

const client = new Client({
  host: process.env.DB_HOST,
  port: process.env.DB_PORT,
  database: process.env.DB_NAME,
  user: process.env.DB_USER,
  password: process.env.DB_PASSWORD,
});

client.connect()
  .then(() => {
    console.log('\n‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!');
    return client.query('SELECT NOW()');
  })
  .then((result) => {
    console.log('üìÖ –í—Ä–µ–º—è –ë–î:', result.rows[0].now);
    client.end();
  })
  .catch((error) => {
    console.error('\n‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:');
    console.error('–ö–æ–¥:', error.code);
    console.error('–°–æ–æ–±—â–µ–Ω–∏–µ:', error.message);
    console.error('\nüí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:');
    console.error('1. –ü–∞—Ä–æ–ª—å –≤ .env —Ñ–∞–π–ª–µ');
    console.error('2. –ó–∞–ø—É—â–µ–Ω –ª–∏ PostgreSQL');
    console.error('3. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö marina_crm');
    process.exit(1);
  });
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
node test-db-connection.js
```

---

## üìû –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–º–æ—â—å

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PostgreSQL
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 5432 –Ω–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ pgAdmin —Å —Ç–µ–º–∏ –∂–µ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª ‚Äî –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ª–∏ –æ–Ω –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

---

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:**
```bash
npm run migrate
```

