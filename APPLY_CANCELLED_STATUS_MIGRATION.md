# üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ 'cancelled' –≤ payment_status enum

## ‚ö†Ô∏è –í–ê–ñ–ù–û
–ú–∏–≥—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –Ω–∞ **–ø—Ä–æ–¥–∞–∫—à–Ω –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö** (Supabase), –∏–Ω–∞—á–µ –ø–ª–∞—Ç–µ–∂–∏ –Ω–µ —Å–º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å `CANCELLED`.

---

## üìù –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ Supabase SQL Editor (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [supabase.com](https://supabase.com)
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç Marina CRM

### –®–∞–≥ 2: –û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor
1. –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ **"SQL Editor"**
2. –ù–∞–∂–º–∏—Ç–µ **"New query"** (–ù–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å)

### –®–∞–≥ 3: –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `src/database/add-payment-status-cancelled-simple.sql`
2. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor
3. –ù–∞–∂–º–∏—Ç–µ **"Run"** (–í—ã–ø–æ–ª–Ω–∏—Ç—å) –∏–ª–∏ `Ctrl+Enter` / `Cmd+Enter`

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:
```
‚úÖ –°—Ç–∞—Ç—É—Å "cancelled" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ enum payment_status_enum
```

–ò–ª–∏, –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
```
‚ÑπÔ∏è –°—Ç–∞—Ç—É—Å "cancelled" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ enum payment_status_enum
```

---

## üìù –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø)

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `psql`:

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ Supabase
psql "postgresql://postgres:[PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres"

# –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç
\i src/database/add-payment-status-cancelled-simple.sql
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:

```bash
psql "postgresql://postgres:[PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres" \
  -f src/database/add-payment-status-cancelled-simple.sql
```

---

## üìù –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ TypeScript —Å–∫—Ä–∏–ø—Ç (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)

–ï—Å–ª–∏ —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –±–∞–∑—ã:

```bash
npm run add-payment-status-cancelled
```

‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` —Ñ–∞–π–ª–µ —É–∫–∞–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è **–ø—Ä–æ–¥–∞–∫—à–Ω –±–∞–∑—ã**, –∞ –Ω–µ –ª–æ–∫–∞–ª—å–Ω–æ–π!

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å—Ç–∞—Ç—É—Å –¥–æ–±–∞–≤–ª–µ–Ω:

### –í Supabase SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π enum payment_status_enum
SELECT enumlabel 
FROM pg_enum 
WHERE enumtypid = (
    SELECT oid 
    FROM pg_type 
    WHERE typname = 'payment_status_enum'
)
ORDER BY enumsortorder;
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è:
- `pending`
- `paid`
- `overdue`
- `refunded`
- `cancelled` ‚Üê **—ç—Ç–æ –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**

---

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "enum label 'cancelled' already exists"
‚úÖ –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –°—Ç–∞—Ç—É—Å —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω, –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç—É.

### –û—à–∏–±–∫–∞: "type 'payment_status_enum' does not exist"
‚ùå –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏–º—è enum –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –ù–∞–π—Ç–∏ –∏–º—è enum –¥–ª—è –∫–æ–ª–æ–Ω–∫–∏ status —Ç–∞–±–ª–∏—Ü—ã payments
SELECT t.typname as enum_name
FROM pg_type t
JOIN pg_attribute a ON a.atttypid = t.oid
JOIN pg_class c ON c.oid = a.attrelid
WHERE c.relname = 'payments' 
AND a.attname = 'status'
AND t.typtype = 'e';
```

–ï—Å–ª–∏ –∏–º—è –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `payments_status_enum`), –æ–±–Ω–æ–≤–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏, –∑–∞–º–µ–Ω–∏–≤ `payment_status_enum` –Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω–æ–µ –∏–º—è.

---

## üìå –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:
1. ‚úÖ –ü–ª–∞—Ç–µ–∂–∏ —Å–º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å —Å—Ç–∞—Ç—É—Å `CANCELLED`
2. ‚úÖ –û—Ç–º–µ–Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚úÖ –í—Å–µ –ø–ª–∞—Ç–µ–∂–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `PENDING` –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ `CANCELLED` –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-13  
**–§–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏:** `src/database/add-payment-status-cancelled-simple.sql`

